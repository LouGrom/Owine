{% extends 'base.html.twig' %}

{% block title %}Panier{% endblock %}

{% block body %}
	<h1>Votre panier</h1>
   
        {% if companies is empty %}
        <p>Votre panier est vide !</p>
        {% endif %}
        {% for company in companies %}
        {% set totalQuantityByCompany = 0 %}
        {% set totalAmountByCompany = 0 %}
        <div class="table-responsive">
            <table class="table table-borderless text-center">
                <thead class="thead">
                    <tr>
                        <th scope="col">{{ company.name }}</th>
                        <th scope="col">Quantité</th>
                        <th scope="col">Prix/u</th>
                        <th scope="col">Prix du lot</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>

                {% for cart in carts %}
                    {% if cart.product.company == company %}
                    <tr class="">
                        <td>{{ cart.product.appellation.name }}</td>
                        <td><input value="{{ cart.quantity }}" type="number" style="width: 60px;"></td>
                        {% set totalQuantityByCompany = totalQuantityByCompany + cart.quantity %}
                        <td>{{ cart.product.price }} €</td>
                        <td>{{ cart.totalAmount }} €</td>
                        {% set totalAmountByCompany = totalAmountByCompany + cart.totalAmount %}
                        <td>
                            {{ include('cart/_delete_form.html.twig') }}
                        </td>
                        
                    </tr>
                        {% endif %}
                        {% endfor %}
                    <tr><td colspan="5"><hr></td></tr>
                    <tr>
                        <td>TOTAL</td>
                        <td >{{ totalQuantityByCompany }}</td>
                        <td></td>
                        <td>{{ totalAmountByCompany }} €</td>
                        <td class="text-center"><a class="btn btn-dark" href="{{ path('cart_details',{'companyId': company.id}) }}"><i class="fas fa-shopping-cart mr-2"></i>Valider</a></td>
                    </tr>
                </tbody>
            </table>
        </div>
        {% endfor %}
</div>



{% endblock %}
